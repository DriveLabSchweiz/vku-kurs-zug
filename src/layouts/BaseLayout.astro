---
import '../styles/global.css';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  canonical?: string;
  robots?: string;
  lang?: 'de' | 'en';
}

const { 
  title = 'VKU Zug – Verkehrskundeunterricht im Kanton Zug', 
  description = 'Jetzt Ihren VKU Zug Kurs in Zug buchen: 8 Stunden Verkehrskunde, zentrale Lage, inkl. Material. Plätze sichern!', 
  image = '/vku-zug-hero.png', 
  canonical = 'https://vku-kurs-zug.ch',
  robots = 'index, follow',
  lang = 'de'
} = Astro.props;

const origin = 'https://vku-kurs-zug.ch';
const fullImage = image.startsWith('http') ? image : `${origin}${image}`;

const currentPath = new URL(Astro.request.url).pathname;

// Language Switcher Logic
const isEn = lang === 'en';
const dePath = isEn ? currentPath.replace(/^\/en/, '') || '/' : currentPath;
const enPath = isEn ? currentPath : `/en${currentPath === '/' ? '' : currentPath}`;

// Navigation Links
const navLinks = [
  { href: isEn ? '/en' : '/', label: isEn ? 'Home' : 'Startseite' },
  { href: isEn ? '/en/kursinhalt' : '/kursinhalt', label: isEn ? 'Course Content' : 'Kursinhalt' },
  { href: isEn ? '/en/faq' : '/faq', label: 'FAQ' },
  { href: isEn ? '/en/kontakt' : '/kontakt', label: isEn ? 'Contact' : 'Kontakt' },
];

const footerLinks = {
  vku: {
    title: 'VKU Zug',
    desc: isEn ? 'Traffic theory course in the center of Zug.' : 'Verkehrskundeunterricht im Zentrum von Zug.',
    addr: 'Industriestrasse 50, 6300 Zug',
    tel: 'Tel: +41 41 219 36 60'
  },
  nav: {
    title: 'Navigation',
    links: navLinks
  },
  loc: {
    title: isEn ? 'Locations' : 'Standorte',
    links: [
      { href: isEn ? '/en/ort/zug-hauptbahnhof' : '/ort/zug-hauptbahnhof', label: 'Zug Hauptbahnhof' },
      { href: isEn ? '/en/ort/baar' : '/ort/baar', label: 'Baar' },
      { href: isEn ? '/en/ort/steinhausen' : '/ort/steinhausen', label: 'Steinhausen' },
    ]
  },
  legal: {
    title: isEn ? 'Legal' : 'Rechtliches',
    links: [
      { href: isEn ? '/en/datenschutz' : '/datenschutz', label: isEn ? 'Privacy Policy' : 'Datenschutz' },
      { href: isEn ? '/en/impressum' : '/impressum', label: isEn ? 'Imprint' : 'Impressum' },
    ]
  },
  related: {
    title: isEn ? 'Related Services' : 'Weitere Angebote',
    links: [
      { href: 'https://nothelferkurs-zuerich.ch', label: isEn ? 'First Aid Course Zurich' : 'Nothelferkurs Zürich', external: true },
      { href: 'https://english-vku-zurich.ch', label: 'VKU English Zurich', external: true },
      { href: 'https://drivelab.ch', label: isEn ? 'DriveLab Driving School' : 'DriveLab Fahrschule', external: true },
    ]
  },
  resources: {
    title: isEn ? 'Official Resources' : 'Offizielle Ressourcen',
    links: [
      { href: 'https://www.astra.admin.ch/', label: 'Bundesamt für Strassen (ASTRA)', external: true },
      { href: 'https://www.bfu.ch/', label: 'BFU - Beratungsstelle für Unfallverhütung', external: true },
      { href: 'https://www.zg.ch/behoerden/sicherheitsdirektion/strassenverkehrsamt', label: isEn ? 'Strassenverkehrsamt Zug' : 'Strassenverkehrsamt Zug', external: true },
      { href: 'https://www.zh.ch/de/mobilitaet/strassenverkehr.html', label: isEn ? 'Strassenverkehr Kanton Zürich' : 'Strassenverkehr Kanton Zürich', external: true },
    ]
  }
};
---

<!DOCTYPE html>
<html lang={isEn ? 'en-CH' : 'de-CH'}>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{title}</title>
  <meta name="description" content={description} />
  <meta name="robots" content={robots} />
  <link rel="canonical" href={canonical} />
  
  <!-- Hreflang Tags -->
  <link rel="alternate" hreflang="de-CH" href={`https://vku-kurs-zug.ch${dePath === '/' ? '' : dePath}`} />
  <link rel="alternate" hreflang="en-CH" href={`https://vku-kurs-zug.ch${enPath === '/' ? '' : enPath}`} />
  
  <!-- Open Graph -->
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={fullImage} />
  <meta property="og:url" content={canonical} />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content={isEn ? 'en_CH' : 'de_CH'} />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={fullImage} />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="alternate icon" href="/favicon.svg" />
  
  <!-- Schema.org Markup - LocalBusiness -->
  <script type="application/ld+json" is:inline set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "VKU Zug – Verkehrskundeunterricht",
    "alternateName": "DriveLab VKU Zug",
    "image": fullImage,
    "description": description,
    "url": canonical,
    "telephone": "+41 41 219 36 60",
    "email": "info@drivelab.ch",
    "priceRange": "CHF 230",
    "currenciesAccepted": "CHF",
    "paymentAccepted": "Cash, Credit Card, TWINT",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Industriestrasse 50",
      "addressLocality": "Zug",
      "postalCode": "6300",
      "addressCountry": "CH"
    },
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 47.1736, 
      "longitude": 8.5167 
    },
    "openingHoursSpecification": [
      {
        "@type": "OpeningHoursSpecification",
        "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
        "opens": "08:00",
        "closes": "18:00"
      }
    ],
    "areaServed": {
      "@type": "City",
      "name": "Zug",
      "containedInPlace": {
        "@type": "State",
        "name": "Kanton Zug"
      }
    },
    "hasOfferCatalog": {
      "@type": "OfferCatalog",
      "name": "VKU Kurse",
      "itemListElement": {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Course",
          "name": "Verkehrskundeunterricht (VKU)",
          "description": "8-stündiger obligatorischer Verkehrskundeunterricht",
          "duration": "PT8H"
        },
        "price": "230",
        "priceCurrency": "CHF"
      }
    },
    "sameAs": [
      "https://drivelab.ch",
      "https://nothelferkurs-zuerich.ch",
      "https://english-vku-zurich.ch"
    ]
  })} />
  
  <!-- Schema.org Markup - Organization -->
  <script type="application/ld+json" is:inline set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "DriveLab GmbH",
    "alternateName": "VKU Zug",
    "url": "https://vku-kurs-zug.ch",
    "logo": "https://vku-kurs-zug.ch/logo.webp",
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+41-41-219-36-60",
      "contactType": "customer service",
      "email": "info@drivelab.ch",
      "areaServed": "CH",
      "availableLanguage": ["de", "en"]
    },
    "sameAs": [
      "https://drivelab.ch",
      "https://nothelferkurs-zuerich.ch",
      "https://english-vku-zurich.ch"
    ]
  })} />
</head>
<body class="bg-white text-gray-900 font-sans">
  <!-- Header & Navigation -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <nav class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href={isEn ? '/en' : '/'} class="flex items-center gap-2">
        <img src="/logo.webp" alt="VKU Zug Logo" class="h-8" />
      </a>
      <div class="hidden md:flex space-x-6 items-center">
        {navLinks.map(link => (
          <a href={link.href} class={`hover:text-blue-600 ${currentPath === link.href ? 'text-blue-600 font-semibold' : ''}`}>{link.label}</a>
        ))}
        <!-- Language Switcher -->
        <div class="flex items-center space-x-2 border-l pl-4 ml-4">
          <a href={dePath} class={`text-sm ${!isEn ? 'font-bold text-blue-600' : 'text-gray-500 hover:text-blue-600'}`}>DE</a>
          <span class="text-gray-300">|</span>
          <a href={enPath} class={`text-sm ${isEn ? 'font-bold text-blue-600' : 'text-gray-500 hover:text-blue-600'}`}>EN</a>
        </div>
      </div>
      <a href="#booking" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">{isEn ? 'Book Now' : 'Jetzt buchen'}</a>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="min-h-screen">
    <slot />
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white mt-12">
    <div class="max-w-6xl mx-auto px-4 py-8">
      <div class="grid grid-cols-1 md:grid-cols-6 gap-8 mb-8">
        <div class="md:col-span-2">
          <h3 class="font-bold text-lg mb-4">{footerLinks.vku.title}</h3>
          <p class="text-gray-400">{footerLinks.vku.desc}</p>
          <p class="text-gray-400 mt-2">{footerLinks.vku.addr}</p>
          <p class="text-gray-400">{footerLinks.vku.tel}</p>
        </div>
        <div>
          <h3 class="font-bold text-lg mb-4">{footerLinks.nav.title}</h3>
          <ul class="space-y-2 text-gray-400">
            {footerLinks.nav.links.map(link => (
              <li><a href={link.href} class="hover:text-white">{link.label}</a></li>
            ))}
          </ul>
        </div>
        <div>
          <h3 class="font-bold text-lg mb-4">{footerLinks.loc.title}</h3>
          <ul class="space-y-2 text-gray-400">
            {footerLinks.loc.links.map(link => (
              <li><a href={link.href} class="hover:text-white">{link.label}</a></li>
            ))}
          </ul>
        </div>
        <div>
          <h3 class="font-bold text-lg mb-4">{footerLinks.related.title}</h3>
          <ul class="space-y-2 text-gray-400">
            {footerLinks.related.links.map(link => (
              <li><a href={link.href} class="hover:text-white" target="_blank" rel="noopener noreferrer">{link.label}</a></li>
            ))}
          </ul>
        </div>
        <div>
          <h3 class="font-bold text-lg mb-4">{footerLinks.resources.title}</h3>
          <ul class="space-y-2 text-gray-400">
            {footerLinks.resources.links.map(link => (
              <li><a href={link.href} class="hover:text-white" target="_blank" rel="noopener noreferrer">{link.label}</a></li>
            ))}
          </ul>
        </div>
      </div>
      <div class="border-t border-gray-700 pt-8 flex flex-col md:flex-row justify-between items-center text-gray-400">
        <p>&copy; 2025 VKU Zug. {isEn ? 'All rights reserved.' : 'Alle Rechte vorbehalten.'}</p>
        <div class="flex space-x-4 mt-4 md:mt-0">
          {footerLinks.legal.links.map(link => (
            <a href={link.href} class="hover:text-white text-sm">{link.label}</a>
          ))}
        </div>
      </div>
    </div>
  </footer>
</body>
</html>
